{
  "version": "1.0.0",
  "description": "Configurable redaction patterns for LSL system",
  "enabled": true,
  "patterns": [
    {
      "id": "env_vars",
      "name": "Environment Variables",
      "description": "API keys and secrets in KEY=value format",
      "pattern": "\\b(ANTHROPIC_API_KEY|ANTHROPIC_ADMIN_API_KEY|OPENAI_API_KEY|OPENAI_ADMIN_API_KEY|GROK_API_KEY|XAI_API_KEY|GEMINI_API_KEY|CLAUDE_API_KEY|GPT_API_KEY|DEEPMIND_API_KEY|COHERE_API_KEY|HUGGINGFACE_API_KEY|HF_API_KEY|REPLICATE_API_KEY|TOGETHER_API_KEY|PERPLEXITY_API_KEY|AI21_API_KEY|GOOGLE_API_KEY|AWS_ACCESS_KEY_ID|AWS_SECRET_ACCESS_KEY|AZURE_API_KEY|GCP_API_KEY|GITHUB_TOKEN|GITLAB_TOKEN|BITBUCKET_TOKEN|NPM_TOKEN|PYPI_TOKEN|DOCKER_TOKEN|SLACK_TOKEN|DISCORD_TOKEN|TELEGRAM_TOKEN|STRIPE_API_KEY|SENDGRID_API_KEY|MAILGUN_API_KEY|TWILIO_AUTH_TOKEN|FIREBASE_API_KEY|SUPABASE_API_KEY|MONGODB_URI|POSTGRES_PASSWORD|MYSQL_PASSWORD|REDIS_PASSWORD|DATABASE_URL|CONNECTION_STRING|JWT_SECRET|SESSION_SECRET|ENCRYPTION_KEY|PRIVATE_KEY|SECRET_KEY|CLIENT_SECRET|API_SECRET|WEBHOOK_SECRET)\\s*=\\s*[\"']?([^\"'\\s\\n]+)[\"']?",
      "flags": "gi",
      "replacementType": "env_var",
      "replacement": "$1=<SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "json_api_keys",
      "name": "JSON API Keys",
      "description": "API keys in JSON format",
      "pattern": "\"(apiKey|API_KEY|ANTHROPIC_API_KEY|OPENAI_API_KEY|XAI_API_KEY|GROK_API_KEY|api_key|anthropicApiKey|openaiApiKey|xaiApiKey|grokApiKey)\":\\s*\"(sk-[a-zA-Z0-9-_]{20,}|xai-[a-zA-Z0-9-_]{20,}|[a-zA-Z0-9-_]{32,})\"",
      "flags": "gi",
      "replacementType": "json_key",
      "replacement": "\"$1\": \"<SECRET_REDACTED>\"",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "sk_ant_admin_keys",
      "name": "Anthropic Admin API Keys",
      "description": "Anthropic Admin API keys with sk-ant-admin- prefix",
      "pattern": "\\bsk-ant-admin-[a-zA-Z0-9_-]{20,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "sk_ant_keys",
      "name": "Anthropic API Keys",
      "description": "Anthropic API keys with sk-ant- prefix (non-admin)",
      "pattern": "\\bsk-ant-[a-zA-Z0-9_-]{20,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "sk_keys",
      "name": "sk- Prefixed Keys",
      "description": "OpenAI and similar API keys with sk- prefix (includes hyphens)",
      "pattern": "\\bsk-[a-zA-Z0-9_-]{20,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "xai_keys",
      "name": "XAI API Keys",
      "description": "XAI/Grok API keys with xai- prefix",
      "pattern": "\\bxai-[a-zA-Z0-9_-]{20,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "groq_keys",
      "name": "Groq API Keys",
      "description": "Groq API keys with gsk_ prefix",
      "pattern": "\\bgsk_[a-zA-Z0-9]{20,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_access_key_id_json",
      "name": "AWS Access Key ID (JSON)",
      "description": "AWS Access Key IDs in JSON format (AKIA*/ASIA* prefixes)",
      "pattern": "\"(AccessKeyId|aws_access_key_id|accessKeyId)\"\\s*:\\s*\"(A[SK]IA[A-Z0-9]{12,})\"",
      "flags": "gi",
      "replacementType": "json_key",
      "replacement": "\"$1\": \"<AWS_KEY_REDACTED>\"",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_secret_access_key_json",
      "name": "AWS Secret Access Key (JSON)",
      "description": "AWS Secret Access Keys in JSON format (40+ char base64-like)",
      "pattern": "\"(SecretAccessKey|aws_secret_access_key|secretAccessKey)\"\\s*:\\s*\"([a-zA-Z0-9+/]{20,})\"",
      "flags": "gi",
      "replacementType": "json_key",
      "replacement": "\"$1\": \"<AWS_SECRET_REDACTED>\"",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_session_token_json",
      "name": "AWS Session Token (JSON)",
      "description": "AWS Session Tokens in JSON format (long base64 strings, may span lines)",
      "pattern": "\"(SessionToken|aws_session_token|sessionToken)\"\\s*:\\s*\"([a-zA-Z0-9+/=\\s]{50,})\"",
      "flags": "gi",
      "replacementType": "json_key",
      "replacement": "\"$1\": \"<AWS_TOKEN_REDACTED>\"",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_session_token_standalone",
      "name": "AWS Session Token (Standalone)",
      "description": "AWS STS Session Tokens with IQoJb3JpZ2lu base64 prefix (decoded: {\"origin\")",
      "pattern": "IQoJb3JpZ2lu[a-zA-Z0-9+/=]{20,}",
      "flags": "g",
      "replacementType": "generic",
      "replacement": "<AWS_TOKEN_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_session_token_truncated",
      "name": "AWS Session Token (Truncated refs)",
      "description": "Truncated AWS Session Token references in logs/docs",
      "pattern": "IQoJb3JpZ2lu[a-zA-Z0-9+/=]*\\.{2,3}",
      "flags": "g",
      "replacementType": "generic",
      "replacement": "<AWS_TOKEN_REDACTED>...",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_access_key_standalone",
      "name": "AWS Access Key ID (Standalone)",
      "description": "Standalone AWS Access Key IDs (AKIA*/ASIA* prefixes)",
      "pattern": "\\bA[SK]IA[A-Z0-9]{12,}\\b",
      "flags": "g",
      "replacementType": "generic",
      "replacement": "<AWS_KEY_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_secret_standalone",
      "name": "AWS Secret Access Key (Standalone)",
      "description": "Standalone AWS Secret Access Keys (40 char base64-like with + and /)",
      "pattern": "[a-zA-Z0-9+/]{40}",
      "flags": "g",
      "replacementType": "generic",
      "replacement": "<AWS_SECRET_REDACTED>",
      "enabled": true,
      "severity": "high"
    },
    {
      "id": "aws_secret_in_context",
      "name": "AWS Secret in Context",
      "description": "AWS Secrets appearing after keywords like Secret:, SecretKey:, etc.",
      "pattern": "(Secret|SecretKey|SecretAccessKey|secret_key)[:\\s]+[a-zA-Z0-9+/]{20,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "$1: <AWS_SECRET_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_secret_truncated",
      "name": "AWS Secret (Truncated)",
      "description": "Truncated AWS secrets in logs (base64-like followed by ...)",
      "pattern": "[a-zA-Z0-9+/]{8,}\\+[a-zA-Z0-9+/]*\\.{2,3}",
      "flags": "g",
      "replacementType": "generic",
      "replacement": "<AWS_SECRET_REDACTED>...",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "aws_credentials_block",
      "name": "AWS Credentials Block",
      "description": "Full AWS credentials JSON blocks from CLI output",
      "pattern": "\\{[^}]*[\"']?(AccessKeyId|Credentials)[\"']?[^}]*\\}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "{<AWS_CREDENTIALS_REDACTED>}",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "generic_api_keys",
      "name": "Generic API Keys",
      "description": "Common API key formats with dashes/underscores",
      "pattern": "\\b[a-zA-Z0-9]{32,}[-_][a-zA-Z0-9]{8,}",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<SECRET_REDACTED>",
      "enabled": true,
      "severity": "high"
    },
    {
      "id": "bearer_tokens",
      "name": "Bearer Tokens",
      "description": "Authorization Bearer tokens",
      "pattern": "Bearer\\s+[a-zA-Z0-9\\-._~+\\/]{20,}",
      "flags": "gi",
      "replacementType": "bearer_token",
      "replacement": "Bearer <TOKEN_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "jwt_tokens",
      "name": "JWT Tokens",
      "description": "JSON Web Tokens (three base64 parts)",
      "pattern": "\\beyJ[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]+",
      "flags": "gi",
      "replacementType": "generic",
      "replacement": "<JWT_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "mongodb_urls",
      "name": "MongoDB Connection Strings",
      "description": "MongoDB connection URLs with credentials",
      "pattern": "mongodb(\\+srv)?:\\/\\/[^:]+:[^@]+@[^\\s]+",
      "flags": "gi",
      "replacementType": "connection_string",
      "replacement": "mongodb://<CONNECTION_STRING_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "postgres_urls",
      "name": "PostgreSQL Connection Strings",
      "description": "PostgreSQL connection URLs with credentials",
      "pattern": "postgres(ql)?:\\/\\/[^:]+:[^@]+@[^\\s]+",
      "flags": "gi",
      "replacementType": "connection_string",
      "replacement": "postgresql://<CONNECTION_STRING_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "mysql_urls",
      "name": "MySQL Connection Strings",
      "description": "MySQL connection URLs with credentials",
      "pattern": "mysql:\\/\\/[^:]+:[^@]+@[^\\s]+",
      "flags": "gi",
      "replacementType": "connection_string",
      "replacement": "mysql://<CONNECTION_STRING_REDACTED>",
      "enabled": true,
      "severity": "critical"
    },
    {
      "id": "generic_urls_with_auth",
      "name": "Generic URLs with Credentials",
      "description": "HTTP/HTTPS URLs with embedded credentials",
      "pattern": "https?:\\/\\/[^:]+:[^@]+@[^\\s]+",
      "flags": "gi",
      "replacementType": "connection_string",
      "replacement": "http://<URL_WITH_CREDENTIALS_REDACTED>",
      "enabled": true,
      "severity": "high"
    },
    {
      "id": "email_addresses",
      "name": "Email Addresses",
      "description": "Personal and corporate email addresses",
      "pattern": "\\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\\b",
      "flags": "gi",
      "replacementType": "email",
      "replacement": "<EMAIL_REDACTED>",
      "enabled": true,
      "severity": "medium"
    },
    {
      "id": "corporate_user_ids",
      "name": "Corporate User IDs",
      "description": "Corporate user identifiers (q + 6 characters)",
      "pattern": "\\bq[0-9a-zA-Z]{6}\\b",
      "flags": "gi",
      "replacementType": "user_id",
      "replacement": "<USER_ID_REDACTED>",
      "enabled": true,
      "severity": "medium"
    },
    {
      "id": "corporate_names",
      "name": "Corporate Company Names",
      "description": "Well-known corporate and brand names",
      "pattern": "\\b(BMW|Mercedes|Audi|Tesla|Microsoft|Google|Apple|Amazon|Meta|Facebook|IBM|Oracle|Cisco|Intel|Dell|HP|Lenovo|Samsung|LG|Sony|Panasonic|Siemens|SAP|Accenture|Deloitte|McKinsey|BCG|Bain|Goldman|Morgan|JPMorgan|Deutsche Bank|Commerzbank|Allianz|Munich Re|BASF|Bayer|Volkswagen|Porsche|Bosch|Continental|Airbus|Boeing|Lockheed|Northrop|Raytheon|General Electric|Ford|General Motors|Chrysler|Fiat|Renault|Peugeot|Citroen|Volvo|Scania|MAN|Daimler|ThyssenKrupp|Siemens Energy|RWE|EON|Uniper|TUI|Lufthansa|DHL|UPS|FedEx|TNT|Deutsche Post|Telekom|Vodafone|Orange|BT|Telefonica|Verizon|ATT|Sprint|TMobile)\\b",
      "flags": "gi",
      "replacementType": "company_name",
      "replacement": "<COMPANY_NAME_REDACTED>",
      "enabled": true,
      "severity": "low"
    }
  ]
}