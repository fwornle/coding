@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant "Client" as client
participant "UkbCli" as ukbcli
participant "VkbApiClient" as vkbapi
participant "Knowledge Management" as km
participant "UKB Unified" as ukb
participant "MCP Semantic Analysis" as mcp
database "Graph Database" as graphdb

client -> ukbcli : initialize()
activate ukbcli

ukbcli -> vkbapi : createClient()
activate vkbapi

ukbcli -> km : loadKnowledgeComponents()
activate km
km -> graphdb : queryNodes()
km -> graphdb : queryRelationships()
km --> ukbcli : knowledgeData
deactivate km

ukbcli -> ukb : initializeUnifiedLayer()
activate ukb
ukb -> graphdb : establishConnections()
ukb --> ukbcli : unifiedInterface
deactivate ukb

client -> ukbcli : executeQuery(query)
ukbcli -> vkbapi : processQuery(query)
vkbapi -> mcp : semanticAnalysis(query)
activate mcp
mcp -> graphdb : analyzeSemantics()
mcp --> vkbapi : analyzedQuery
deactivate mcp

vkbapi -> ukb : executeUnifiedQuery(analyzedQuery)
ukb -> graphdb : executeGraphQuery()
graphdb --> ukb : results
ukb --> vkbapi : processedResults
vkbapi --> ukbcli : queryResults
deactivate vkbapi

ukbcli --> client : formattedResults
deactivate ukbcli

note over graphdb : Core graph database storage\nNo shared-memory.json dependency

note over ukbcli, mcp : Distributed across:\n- src/knowledge-management\n- lib/ukb-unified\n- integrations/mcp-server-semantic-analysis/src

@enduml