@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant UkbCli as "UkbCli (MCPAgent)"
participant GraphDatabaseService as "Graph Database Service"
participant GraphKnowledgeExporter as "Graph Knowledge Exporter"
participant Graphology as "Graphology"
participant LevelDB as "LevelDB"

UkbCli->>GraphDatabaseService: Request knowledge storage
GraphDatabaseService->>Graphology: Store knowledge in graph
Graphology->>LevelDB: Persist graph data
LevelDB->>Graphology: Confirm data persistence

UkbCli->>GraphKnowledgeExporter: Request knowledge export
GraphKnowledgeExporter->>GraphDatabaseService: Retrieve knowledge from graph
GraphDatabaseService->>GraphKnowledgeExporter: Provide knowledge for export
GraphKnowledgeExporter->>UkbCli: Export knowledge

alt Visualization
    UkbCli->>GraphDatabaseService: Request knowledge for visualization
    GraphDatabaseService->>Graphology: Retrieve graph for visualization
    Graphology->>UkbCli: Provide graph for vkb command
end

opt Synchronization
    UkbCli->>GraphKnowledgeExporter: Request knowledge synchronization
    GraphKnowledgeExporter->>GraphDatabaseService: Retrieve knowledge for sync
    GraphDatabaseService->>GraphKnowledgeExporter: Provide knowledge for sync
    GraphKnowledgeExporter->>UkbCli: Confirm knowledge synchronization
end

@enduml