@startuml knowledge-management-system-architecture-enhanced
!theme plain
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam maxMessageSize 60

title Knowledge Management System - Enhanced with AI Agents

' Vertical layout for narrower diagram
top to bottom direction

package "Data Sources" as DataSources {
    [Git Repository] as GitRepo
    [AI Conversations] as AIConv  
    [Expert Input] as ExpertInput
    [Project Files] as ProjectFiles
}

package "AI Agent Integration" as AgentIntegration {
    [Claude Code] as Claude
    [GitHub Copilot] as Copilot
    [Other Agents] as OtherAgents
    [Agent Abstraction] as AgentLayer
}

package "Enhanced Processing" as Processing {
    frame "Traditional Tools" {
        [UKB Engine] as UKB
        [VKB Visualizer] as VKB
    }
    
    frame "AI-Powered Analysis" {
        [Semantic Analysis Agent] as SA
        [Web Search Agent] as WS
        [Knowledge Graph Agent] as KG
        [Coordinator Agent] as CA
    }
    
    [Pattern Recognition] as PatternRec
    [Significance Scoring] as SigScore
    [Entity Deduplication] as Dedup
}

package "Communication Infrastructure" as CommInfra {
    [MQTT Broker] as MQTT
    [JSON-RPC Server] as RPC
    [MCP Server] as MCPServer
}

package "Storage Layer" as Storage {
    [GraphDB + LevelDB] as SharedMemory
    [MCP Memory Server] as MCPMemory
    [Knowledge Graph] as GraphDB
    [Documentation] as Docs
}

package "Visualization & Access" as Visualization {
    [VKB Web Interface] as WebUI
    [Interactive Graph] as Graph
    [Search & Filter] as Search
    [Real-time Updates] as Updates
}

package "External Services" as External {
    [LLM Providers] as LLM
    [Search Engines] as SearchEngines
    [Documentation APIs] as DocAPIs
}

' Agent integration flow
AgentIntegration --> CommInfra : MCP/API calls
Claude --> MCPServer : native integration
Copilot --> AgentLayer : fallback services
OtherAgents --> RPC : direct API

' Data flow
DataSources --> Processing : raw data
GitRepo --> SA : code analysis
AIConv --> SA : conversation analysis
ExpertInput --> UKB : manual entry

' AI processing flow
MCPServer --> SA : analyze requests
MCPServer --> WS : search requests
MCPServer --> KG : entity requests
MCPServer --> CA : workflow requests

SA --> MQTT : analysis events
WS --> MQTT : search events
KG --> MQTT : entity events
CA --> MQTT : workflow events

SA --> RPC : sync results
WS --> RPC : sync results
KG --> RPC : sync results
CA --> RPC : sync results

' Enhanced processing
Processing --> PatternRec : enhanced detection
Processing --> SigScore : AI-powered scoring
Processing --> Dedup : intelligent merging

' Storage integration
KG --> SharedMemory : bidirectional sync
Processing --> MCPMemory : runtime storage
MCPMemory --> SharedMemory : persistence
SharedMemory --> GraphDB : structured data

' Visualization
Storage --> Visualization : knowledge data
Visualization --> Updates : real-time sync

' External connections
SA --> LLM : analysis requests
WS --> SearchEngines : web search
WS --> DocAPIs : technical docs

' User interactions
actor Developer as Dev
actor Team as Team

Dev --> AgentIntegration : coding with AI
Team --> Visualization : explore knowledge
Dev --> UKB : manual insights
Team --> WebUI : collaborative exploration

note top of DataSources
  **Input Sources:**
  • Git commits & diffs
  • AI-assisted conversations
  • Manual expert knowledge
  • Project documentation
end note

note top of Processing
  **Hybrid Analysis:**
  • Traditional UKB/VKB tools
  • AI multi-agent analysis
  • Pattern recognition
  • Intelligent scoring
end note

note top of Storage
  **Multi-Layer Persistence:**
  • GraphDB (Graphology+LevelDB)
  • Runtime (MCP Memory)
  • Git-tracked exports
  • Cross-session continuity
end note

note top of Visualization
  **Enhanced Visualization:**
  • AI-generated entities
  • Traditional manual entries
  • Real-time updates
  • Interactive exploration
end note

@enduml