@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant GraphDatabaseService as "Graph Database Service"
participant GraphDatabaseAdapter as "Graph Database Adapter"
participant GraphKnowledgeExporter as "Graph Knowledge Exporter"
participant vkb as "vkb Command"
participant graph-sync as "graph-sync Command"
participant MCP_server as "MCP Server"
participant LevelDB as "LevelDB Storage"
participant JSON_Export as "JSON Export"

note over GraphDatabaseService: Initialization
GraphDatabaseService ->> LevelDB: Initialize Graph Storage
GraphDatabaseAdapter ->> LevelDB: Configure Storage Adapter
GraphKnowledgeExporter ->> LevelDB: Register Exporter

vkb ->> GraphDatabaseService: Request Visualization
graph-sync ->> GraphDatabaseService: Request Synchronization

GraphDatabaseService ->> GraphDatabaseAdapter: Fetch Graph Data
GraphDatabaseAdapter ->> LevelDB: Retrieve Data
LevelDB ->> GraphDatabaseAdapter: Return Data
GraphDatabaseAdapter ->> GraphDatabaseService: Return Fetched Data

GraphDatabaseService ->> GraphKnowledgeExporter: Export Knowledge
GraphKnowledgeExporter ->> JSON_Export: Export to JSON
JSON_Export ->> GraphKnowledgeExporter: Confirm Export

graph-sync ->> GraphDatabaseService: Sync Request
GraphDatabaseService ->> MCP_server: Sync with MCP Server
MCP_server ->> GraphDatabaseService: Return Sync Response
GraphDatabaseService ->> graph-sync: Return Sync Result

note over GraphDatabaseService: Auto-Sync
GraphKnowledgeExporter ->> JSON_Export: Auto-Export Knowledge
JSON_Export ->> GraphKnowledgeExporter: Confirm Auto-Export

@enduml