@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant MCPAgent as "MCP Agent"
participant GraphDatabaseService as "Graph Database Service"
participant GraphKnowledgeExporter as "Graph Knowledge Exporter"
participant PersistenceAgent as "Persistence Agent"
participant VkbApiClient as "Vkb Api Client"
participant Graphology as "Graphology"
participant LevelDB as "LevelDB"

MCPAgent->>GraphDatabaseService: Request knowledge graph
GraphDatabaseService->>Graphology: Retrieve knowledge graph
Graphology->>LevelDB: Store knowledge graph
LevelDB->>Graphology: Return stored knowledge graph
Graphology->>GraphDatabaseService: Return knowledge graph
GraphDatabaseService->>MCPAgent: Return knowledge graph

MCPAgent->>GraphKnowledgeExporter: Request JSON export
GraphKnowledgeExporter->>GraphDatabaseService: Retrieve knowledge graph
GraphDatabaseService->>Graphology: Retrieve knowledge graph
Graphology->>LevelDB: Retrieve knowledge graph
LevelDB->>Graphology: Return retrieved knowledge graph
Graphology->>GraphDatabaseService: Return knowledge graph
GraphDatabaseService->>GraphKnowledgeExporter: Return knowledge graph
GraphKnowledgeExporter->>MCPAgent: Return JSON export

MCPAgent->>PersistenceAgent: Perform knowledge operation
PersistenceAgent->>VkbApiClient: Perform knowledge operation
VkbApiClient->>GraphDatabaseService: Update knowledge graph
GraphDatabaseService->>Graphology: Update knowledge graph
Graphology->>LevelDB: Update knowledge graph
LevelDB->>Graphology: Confirm update
Graphology->>GraphDatabaseService: Confirm update
GraphDatabaseService->>VkbApiClient: Confirm update
VkbApiClient->>PersistenceAgent: Confirm update
PersistenceAgent->>MCPAgent: Confirm update

MCPAgent->>VkbApiClient: Sync data
VkbApiClient->>GraphDatabaseService: Sync data
GraphDatabaseService->>Graphology: Sync data
Graphology->>LevelDB: Sync data
LevelDB->>Graphology: Confirm sync
Graphology->>GraphDatabaseService: Confirm sync
GraphDatabaseService->>VkbApiClient: Confirm sync
VkbApiClient->>MCPAgent: Confirm sync

@enduml