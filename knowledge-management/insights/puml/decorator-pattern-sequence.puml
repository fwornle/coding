@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant GraphDatabaseService as "Graph Database Service"
participant PersistenceAgent as "Persistence Agent"
participant VkbApiClient as "VKB API Client"
participant DecoratorPattern as "Decorator Pattern"

note over GraphDatabaseService: Microservices-based architecture
GraphDatabaseService ->> PersistenceAgent: Request data storage
PersistenceAgent ->> GraphDatabaseService: Store data in Graphology + LevelDB

note over GraphDatabaseService: Event-driven approach
GraphDatabaseService ->> VkbApiClient: Trigger event for batch mode semantic analysis
VkbApiClient ->> GraphDatabaseService: Process event with parallel workers

alt Access control check
    GraphDatabaseService ->> VkbApiClient: Request access control for data storage
    VkbApiClient ->> GraphDatabaseService: Grant access control for data storage
else Data consistency issue
    note over GraphDatabaseService: Data consistency issue due to removal of shared-memory.json
    GraphDatabaseService ->> PersistenceAgent: Handle data inconsistency
    note over GraphDatabaseService: Applying Decorator Pattern for added behavior
    DecoratorPattern ->> GraphDatabaseService: Add behavior without modifying structure
    GraphDatabaseService ->> DecoratorPattern: Enhance functionality with added behavior
end

@enduml