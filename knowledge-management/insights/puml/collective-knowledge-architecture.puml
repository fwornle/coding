@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

title CollectiveKnowledge System Architecture

package "Core Commands" {
  component [vkb] <<command>>
  component [coding] <<command>>
  component [graph-sync] <<command>>
}

package "Knowledge Management Services" {
  component [GraphDatabaseService] <<core>>
  component [GraphKnowledgeExporter] <<core>>
  component [GraphDatabaseAdapter] <<core>>
  component [PersistenceAgent] <<agent>>
  component [VkbApiClient] <<api>>
}

package "Storage Layer" {
  package ".data/knowledge-graph" {
    component [Graphology] <<storage>>
    component [LevelDB] <<storage>>
  }
  
  package ".data/knowledge-export" {
    component [JSON Exports] <<storage>>
  }
}

note as N1
  Hybrid knowledge management system with graph-based storage
  and automated synchronization capabilities
end note

[vkb] --> [GraphDatabaseService]
[coding] --> [GraphDatabaseService]
[graph-sync] --> [GraphKnowledgeExporter]

[GraphDatabaseService] --> [GraphDatabaseAdapter]
[GraphDatabaseAdapter] --> [Graphology]
[Graphology] --> [LevelDB]

[GraphKnowledgeExporter] --> [JSON Exports]
[PersistenceAgent] --> [Graphology]
[PersistenceAgent] --> [JSON Exports]

[VkbApiClient] --> [JSON Exports] : external access

note right of [JSON Exports] : Automated synchronization\nfor external access

note bottom of [Graphology] : Primary storage with\nhybrid architecture

@enduml