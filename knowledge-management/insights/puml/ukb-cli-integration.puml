@startuml ukb-cli-integration
!theme plain
skinparam backgroundColor white
skinparam roundcorner 20
skinparam shadowing false
title UkbCli Integration with UKB Bash Script

actor "Developer" as dev
participant "UKB Script" as ukb
participant "UkbCli Process" as cli
participant "Knowledge Manager" as km
participant "GraphDB + LevelDB" as memory
participant "MCP Memory" as mcp
participant "VKB Visualizer" as vkb

== Interactive Mode ==
dev -> ukb : ukb --interactive
ukb -> cli : node ukb-cli --interactive
activate cli

cli -> dev : Prompt: Problem description?
dev -> cli : "Complex bash script maintainability"
cli -> dev : Prompt: Solution approach?
dev -> cli : "Refactor to Node.js with modular design"
cli -> dev : Prompt: Why this approach?
dev -> cli : "Better cross-platform support"
cli -> dev : Prompt: Key learnings?
dev -> cli : "Planning preserves functionality"
cli -> dev : Prompt: Technologies?
dev -> cli : "Node.js, CLI frameworks"
cli -> dev : Prompt: References (URLs)?
dev -> cli : "https://nodejs.org/docs/cli"

cli -> km : validate_content()
km -> km : filter_marketing_language()
km -> km : validate_urls()
cli -> km : create_entity()
km -> memory : write_json()
km -> mcp : sync_memory()
km -> vkb : update_visualizer()

cli -> ukb : success_response()
deactivate cli
ukb -> dev : âœ… Entity created: UkbCli

== Automated Mode ==
dev -> ukb : ukb --auto
ukb -> cli : node ukb-cli --analyze-commits
activate cli

cli -> cli : analyze_git_history()
cli -> cli : extract_patterns()
cli -> km : auto_create_insights()
km -> memory : append_entities()
km -> mcp : sync_changes()
km -> vkb : update_display()

cli -> ukb : summary_report()
deactivate cli
ukb -> dev : ðŸ“Š Analysis complete

== Custom Entity Creation ==
dev -> ukb : UKB_CUSTOM_NAME="MyPattern" ukb --interactive
ukb -> cli : node ukb-cli --name "MyPattern"
activate cli

cli -> cli : set_custom_name("MyPattern")
cli -> dev : [Interactive prompts...]
cli -> km : create_entity(name="MyPattern")

deactivate cli

note right of cli
  **UkbCli Responsibilities:**
  - Input validation & sanitization
  - Content quality enforcement
  - Structured data creation
  - Cross-platform compatibility
end note

note right of ukb
  **UKB Script Role:**
  - Environment setup
  - CLI orchestration
  - Legacy bash compatibility
  - Error handling wrapper
end note

@enduml