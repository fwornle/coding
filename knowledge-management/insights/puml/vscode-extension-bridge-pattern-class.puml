@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "VSCode Extension Bridge Pattern" {
    abstract class TransferablePattern <<pattern>> {
        +transferData()
        +validateStructure()
    }
    
    class VSCodeExtensionBridgePattern {
        -bridgeConfig: Configuration
        +initializeBridge()
        +handleExtensionCommunication()
    }
}

package "Knowledge Graph Storage" {
    class GraphDatabaseService <<service>> {
        -graphology: GraphologyInstance
        -levelDB: LevelDBInstance
        +queryGraph()
        +updateNodes()
        +syncToExport()
    }
    
    class GraphDatabaseAdapter <<adapter>> {
        -dataPath: String
        +connect()
        +executeQuery()
        +handleTransaction()
    }
    
    class PersistenceAgent <<agent>> {
        -validationRules: ValidationRule[]
        +validateData()
        +persistToStorage()
        +handleRollback()
    }
    
    class GraphKnowledgeExporter <<exporter>> {
        -exportPath: String
        +exportToJSON()
        +validateExport()
        +scheduleSync()
    }
}

package "API and Commands" {
    class VkbApiClient <<client>> {
        -apiEndpoint: String
        -authToken: String
        +sendVisualizationRequest()
        +handleApiResponse()
        +manageConnection()
    }
    
    class VkbCommand <<command>> {
        +executeVisualization()
        +handleUserInput()
    }
    
    class GraphSyncCommand <<command>> {
        +executeSynchronization()
        +validateSyncStatus()
    }
}

package "Semantic Analysis Integration" {
    class MCPServer <<server>> {
        -serverConfig: Configuration
        +processSemanticAnalysis()
        +extractKnowledge()
        +classifyContent()
    }
    
    class SemanticAnalysisIntegration <<integration>> {
        -analysisRules: AnalysisRule[]
        +performAutomatedExtraction()
        +integrateWithKnowledgeGraph()
    }
}

package "Data Storage" {
    class DataDirectory <<file>> {
        +knowledgeGraphPath: "/data/knowledge-graph"
        +knowledgeExportPath: "/data/knowledge-export"
    }
}

' Inheritance
TransferablePattern <|-- VSCodeExtensionBridgePattern

' Composition relationships
GraphDatabaseService *-- GraphDatabaseAdapter
GraphDatabaseService *-- PersistenceAgent
GraphDatabaseService *-- GraphKnowledgeExporter

' Dependencies
VSCodeExtensionBridgePattern ..> GraphDatabaseService : uses
VkbApiClient ..> GraphDatabaseService : communicates
VkbCommand ..> VkbApiClient : invokes
GraphSyncCommand ..> GraphDatabaseService : synchronizes

' Storage relationships
GraphDatabaseService --> DataDirectory : stores data
GraphKnowledgeExporter --> DataDirectory : exports to

' MCP Integration
MCPServer *-- SemanticAnalysisIntegration
SemanticAnalysisIntegration ..> GraphDatabaseService : feeds data

' Command relationships
VkbCommand ..> GraphDatabaseService : visualizes
GraphSyncCommand ..> GraphKnowledgeExporter : triggers export

note top of VSCodeExtensionBridgePattern : "Main bridge pattern for VSCode extension\nintegration with knowledge graph system"

note bottom of GraphDatabaseService : "Uses Graphology + LevelDB with\nauto-sync to JSON exports"

note right of MCPServer : "Located at integrations/mcp-server-\nsemantic-analysis/src"

@enduml