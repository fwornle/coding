@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "Knowledge Persistence Pattern" {
  note as AutoNote2
    Purpose: Store and manage knowledge in a graph database
  end note
  component GraphDatabase <<storage>> as "Graph Database"
  component LevelDB <<storage>> as "LevelDB"
  component GraphKnowledgeExporter <<core>> as "Graph Knowledge Exporter"
  component PersistenceAgent <<agent>> as "Persistence Agent"
  component VkbApiClient <<api>> as "Vkb Api Client"
  
  GraphDatabase --* GraphKnowledgeExporter
  GraphDatabase --* PersistenceAgent
  LevelDB --* GraphDatabase
  VkbApiClient --* GraphDatabase
}

package "Command Line Interface" {
  component vkb <<api>> as "vkb command"
  component coding <<api>> as "coding command"
  component graph_sync <<api>> as "graph-sync command"
  vkb --* GraphDatabase
  coding --* GraphDatabase
  graph_sync --* GraphDatabase
  graph_sync --* GraphKnowledgeExporter
}

package "Data Storage" {
  component knowledge_graph <<storage>> as ".data/knowledge-graph"
  component knowledge_export <<storage>> as ".data/knowledge-export"
  
  GraphDatabase --* knowledge_graph
  GraphKnowledgeExporter --* knowledge_export
  knowledge_graph --* knowledge_export
}

GraphDatabase ..> VkbApiClient : uses
PersistenceAgent ..> GraphDatabase : persists
GraphKnowledgeExporter ..> knowledge_export : exports

note as AutoNote1
  Relationships:
  - GraphDatabase uses VkbApiClient
  - PersistenceAgent persists GraphDatabase
  - GraphKnowledgeExporter exports knowledge
end note

@enduml