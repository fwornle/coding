@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "Knowledge Management Core" {
    component [src/knowledge-management] <<core>> as KnowledgeCore
    component [GraphDatabaseService] <<core>> as GraphDB
    component [PersistenceAgent] <<agent>> as PersistAgent
}

package "Shared Utilities" {
    component [lib/ukb-unified] <<core>> as SharedUtils
    component [GraphDatabaseAdapter] <<core>> as GraphAdapter
}

package "Analysis Services" {
    component [integrations/mcp-server-semantic-analysis/src] <<api>> as SemanticAnalysis
    component [ParallelWorker] <<core>> as ParallelWorker
}

package "Storage Layer" {
    database "LevelDB\n(.data/knowledge-graph)" <<storage>> as LevelDB
    component [Graphology] <<storage>> as Graphology
    file "JSON Exports\n(.data/knowledge-export)" <<storage>> as JSONExports
    component [GraphKnowledgeExporter] <<core>> as Exporter
}

package "External Integrations" {
    component [VkbApiClient] <<api>> as ApiClient
}

package "Command Interface" {
    component [vkb] <<api>> as VkbCommand
    component [coding] <<api>> as CodingCommand
    component [graph-sync] <<api>> as SyncCommand
}

' Core relationships
KnowledgeCore --> GraphDB : manages
GraphDB --> PersistAgent : uses
GraphDB --> GraphAdapter : through

' Storage relationships
GraphDB --> Graphology : stores in
Graphology --> LevelDB : persisted by
Exporter --> JSONExports : exports to
Graphology --> Exporter : auto-sync

' Analysis pipeline
SemanticAnalysis --> ParallelWorker : batch processing
ParallelWorker --> GraphDB : integrates with
ParallelWorker --> PersistAgent : works with

' Shared utilities
SharedUtils --> GraphAdapter : provides
GraphAdapter --> SyncCommand : enables

' External integrations
ApiClient --> KnowledgeCore : integrates with
ApiClient --> GraphDB : maintains local persistence

' Command interface
VkbCommand --> KnowledgeCore : visualization
CodingCommand --> KnowledgeCore : development
SyncCommand --> GraphAdapter : data sync

note top of KnowledgeCore : Incremental content constraints\nonly on edit/write operations
note right of SemanticAnalysis : Update classification via\nsemantic analysis pipeline
note bottom of Graphology : Auto-synchronized with\nJSON exports

@enduml