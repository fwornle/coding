@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "Knowledge Management" {
    class ConfigurationPattern <<MCPAgent>> {
        -environmentConfig: Map<String, String>
        -projectConfig: ProjectConfig
        -knowledgeGraph: GraphologyDB
        -exportPath: String
        +loadConfiguration(): void
        +validateConfig(): boolean
        +syncToExport(): void
        +getConfigValue(key: String): String
    }
    
    class KnowledgeStorage {
        -graphDb: GraphologyDB
        -levelDb: LevelDB
        -dataPath: String
        +storeEntity(entity: Object): void
        +retrieveEntity(id: String): Object
        +exportToJson(): void
        +syncData(): void
    }
    
    class GraphologyDB {
        -graphInstance: Graph
        -dbConnection: LevelDB
        +addNode(node: Object): void
        +addEdge(source: String, target: String): void
        +query(pattern: String): Array
        +persist(): void
    }
}

package "Unified Knowledge Base" {
    class UKBUnified {
        -patternRegistry: Map<String, Pattern>
        -configManager: ConfigurationPattern
        +registerPattern(pattern: Pattern): void
        +getPattern(id: String): Pattern
        +exportKnowledge(): void
    }
    
    abstract class Pattern {
        #id: String
        #type: String
        #metadata: Map<String, Object>
        +abstract validate(): boolean
        +export(): Object
    }
}

package "MCP Server Integration" {
    class MCPServerSemanticAnalysis {
        -configPattern: ConfigurationPattern
        -analysisEngine: SemanticEngine
        +analyzeCode(): AnalysisResult
        +extractPatterns(): Array<Pattern>
        +updateKnowledge(): void
    }
    
    class SemanticEngine {
        -knowledgeBase: UKBUnified
        +processSource(code: String): void
        +identifyPatterns(): Array<Pattern>
        +generateInsights(): InsightData
    }
}

package "Data Layer" {
    class LevelDB <<database>> {
        -dbPath: String
        -connection: Connection
        +put(key: String, value: Object): void
        +get(key: String): Object
        +batch(operations: Array): void
    }
    
    class JSONExporter {
        -exportPath: String
        -autoSync: boolean
        +exportData(data: Object): void
        +scheduleSync(): void
        +validateExport(): boolean
    }
}

package "Configuration Layer" {
    class EnvironmentConfig {
        -envVars: Map<String, String>
        +getVar(name: String): String
        +validateRequired(): boolean
    }
    
    class ProjectConfig {
        -configFile: String
        -settings: Map<String, Object>
        +loadFromFile(): void
        +merge(envConfig: EnvironmentConfig): void
    }
}

' Relationships
ConfigurationPattern --> KnowledgeStorage : manages
ConfigurationPattern --> EnvironmentConfig : uses
ConfigurationPattern --> ProjectConfig : uses
KnowledgeStorage --> GraphologyDB : contains
KnowledgeStorage --> JSONExporter : exports via
GraphologyDB --> LevelDB : persists to
UKBUnified --> ConfigurationPattern : configured by
UKBUnified --> Pattern : contains
MCPServerSemanticAnalysis --> ConfigurationPattern : uses
MCPServerSemanticAnalysis --> SemanticEngine : delegates to
SemanticEngine --> UKBUnified : updates
ConfigurationPattern ..|> Pattern : implements
ProjectConfig --> EnvironmentConfig : merges with

note right of ConfigurationPattern : "Extracted from codebase analysis\nStored as reusable knowledge entity"
note bottom of KnowledgeStorage : "Storage at .data/knowledge-graph\nExports to .data/knowledge-export"
note top of LevelDB : "Replaced shared-memory.json\nPersistent graph storage"

@enduml