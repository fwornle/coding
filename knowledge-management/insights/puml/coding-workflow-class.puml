@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "MCP Agent Layer" {
    class CodingWorkflow <<MCPAgent>> {
        +executeWorkflow()
        +performIncrementalAnalysis()
        +processSemanticAnalysis()
    }
    
    interface MCPTools {
        +execute_workflow()
    }
}

package "Knowledge Management" {
    class KnowledgeManager {
        -graphDb: GraphologyAdapter
        -levelDb: LevelDBAdapter
        +storeKnowledge()
        +retrieveKnowledge()
        +syncToExport()
    }
    
    class GraphologyAdapter {
        -graphInstance: Graphology
        +createNode()
        +createEdge()
        +query()
    }
    
    class LevelDBAdapter {
        -dbPath: String
        +put()
        +get()
        +batch()
    }
}

package "Storage Layer" {
    class KnowledgeGraph <<file>> {
        +path: ".data/knowledge-graph"
        +type: "Graphology + LevelDB"
    }
    
    class KnowledgeExport <<file>> {
        +path: ".data/knowledge-export"
        +type: "JSON"
        +autoSynced: true
    }
}

package "Implementation Modules" {
    class SemanticAnalysisModule {
        +analyzeCode()
        +extractPatterns()
        +generateInsights()
    }
    
    class UKBUnifiedLib {
        +processUnifiedData()
        +handleIntegration()
    }
    
    class KnowledgeManagementSrc {
        +manageWorkflow()
        +coordinateAnalysis()
    }
}

' Relationships
CodingWorkflow --> MCPTools : implements
CodingWorkflow --> KnowledgeManager : uses
CodingWorkflow --> SemanticAnalysisModule : orchestrates

KnowledgeManager --> GraphologyAdapter : uses
KnowledgeManager --> LevelDBAdapter : uses
KnowledgeManager --> KnowledgeExport : syncs_to

GraphologyAdapter --> KnowledgeGraph : stores_in
LevelDBAdapter --> KnowledgeGraph : stores_in

SemanticAnalysisModule --> UKBUnifiedLib : integrates_with
SemanticAnalysisModule --> KnowledgeManagementSrc : part_of

MCPTools ..> CodingWorkflow : triggers

note right of KnowledgeGraph : "Replaced shared-memory.json\nwith persistent graph storage"

note bottom of CodingWorkflow : "Triggered via MCP tools or\nautomatic incremental analysis"

@enduml