@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "MCP Server" {
  class SemanticAnalysisWorkflowIssue <<MCPAgent>> {
    -workflowId: string
    -issueContext: object
    -analysisState: AnalysisState
    +processWorkflow(): Promise<void>
    +generateSemanticAnalysis(): Promise<Analysis>
    +coordinateAgents(): Promise<void>
  }
}

package "Knowledge Management" {
  class KnowledgeGraph {
    -graphInstance: Graphology
    -storage: LevelDB
    +addNode(data: NodeData): void
    +addEdge(source: string, target: string): void
    +query(pattern: string): QueryResult[]
    +exportToJSON(): void
  }
  
  class KnowledgeExporter {
    -exportPath: string
    -autoSync: boolean
    +syncFromGraphDB(): Promise<void>
    +exportJSON(): Promise<void>
  }
}

package "Multi-Agent Architecture" {
  abstract class BaseAgent {
    #agentId: string
    #status: AgentStatus
    +abstract execute(): Promise<AgentResult>
    +reportStatus(): AgentStatus
  }

  class GitHistoryAgent <<service>> {
    -repositoryPath: string
    +analyzeCommitHistory(): Promise<CommitAnalysis>
    +extractCodeChanges(): Promise<ChangeSet[]>
  }

  class VibeHistoryAgent <<service>> {
    -contextWindow: number
    +analyzeProjectVibe(): Promise<VibeAnalysis>
    +detectPatterns(): Promise<Pattern[]>
  }

  class ObservationGenerationAgent <<service>> {
    -observationRules: Rule[]
    +generateObservations(): Promise<Observation[]>
    +validateObservations(): Promise<ValidationResult>
  }

  class InsightGenerationAgent <<service>> {
    -insightEngine: InsightEngine
    +synthesizeInsights(): Promise<Insight[]>
    +rankInsightsByRelevance(): Promise<RankedInsight[]>
  }

  class ContentValidationAgent <<service>> {
    -validationCriteria: Criteria[]
    +validateContent(): Promise<ValidationReport>
    +suggestImprovements(): Promise<Improvement[]>
  }

  class QualityAssuranceAgent <<service>> {
    -qualityMetrics: Metric[]
    +assessQuality(): Promise<QualityReport>
    +enforceStandards(): Promise<ComplianceResult>
  }
}

package "Storage Layer" {
  class GraphologyAdapter {
    -graph: Graphology
    +createNode(): Node
    +createEdge(): Edge
    +traverse(): Iterator
  }

  class LevelDBAdapter {
    -dbPath: string
    +put(key: string, value: any): Promise<void>
    +get(key: string): Promise<any>
    +batch(): Promise<void>
  }

  class JSONExportStore <<file>> {
    -exportDirectory: string
    +writeExport(data: object): Promise<void>
    +readExport(): Promise<object>
  }
}

package "Unified Knowledge Base" {
  class UKBUnified {
    -knowledgeGraph: KnowledgeGraph
    -agents: BaseAgent[]
    +integrateAgentResults(): Promise<void>
    +queryUnifiedKnowledge(): Promise<KnowledgeResult>
  }
}

' Relationships
SemanticAnalysisWorkflowIssue --> UKBUnified : coordinates
SemanticAnalysisWorkflowIssue --> BaseAgent : manages
UKBUnified --> KnowledgeGraph : uses
KnowledgeGraph --> GraphologyAdapter : delegates to
KnowledgeGraph --> LevelDBAdapter : persists with
KnowledgeExporter --> JSONExportStore : exports to
KnowledgeExporter --> KnowledgeGraph : syncs from

BaseAgent <|-- GitHistoryAgent
BaseAgent <|-- VibeHistoryAgent  
BaseAgent <|-- ObservationGenerationAgent
BaseAgent <|-- InsightGenerationAgent
BaseAgent <|-- ContentValidationAgent
BaseAgent <|-- QualityAssuranceAgent

GitHistoryAgent --> KnowledgeGraph : feeds data
VibeHistoryAgent --> KnowledgeGraph : feeds data
ObservationGenerationAgent --> KnowledgeGraph : feeds data
InsightGenerationAgent --> KnowledgeGraph : feeds data
ContentValidationAgent --> KnowledgeGraph : feeds data
QualityAssuranceAgent --> KnowledgeGraph : feeds data

@enduml