@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

left to right direction

actor "System Architect" as architect
actor "Developer" as dev
actor "Knowledge Manager" as km
actor "MCP Client" as mcp

package "Knowledge Management System" {
    usecase "Store Architectural Patterns" as store
    usecase "Extract Pattern Knowledge" as extract
    usecase "Query Knowledge Graph" as query
    usecase "Export Knowledge to JSON" as export
    usecase "Sync Graph to Export" as sync
    usecase "Manage Pattern Lifecycle" as lifecycle
}

package "Data Storage Layer" {
    usecase "Persist to GraphDB" as graphdb
    usecase "Store in LevelDB" as leveldb
    usecase "Maintain Knowledge Graph" as maintain
}

package "Integration Layer" {
    usecase "Provide Semantic Analysis" as semantic
    usecase "Serve MCP Protocol" as mcpserve
    usecase "Transfer Patterns" as transfer
}

package "Codebase Analysis" {
    usecase "Analyze Source Code" as analyze
    usecase "Identify Evolution Patterns" as identify
    usecase "Remove Legacy Components" as cleanup
}

architect --> store
architect --> extract
architect --> lifecycle

dev --> query
dev --> analyze
dev --> identify

km --> export
km --> sync
km --> maintain

mcp --> semantic
mcp --> mcpserve
mcp --> transfer

store ..> graphdb : <<include>>
store ..> leveldb : <<include>>

extract --> identify : <<extend>>
extract --> cleanup : <<extend>>

query ..> maintain : <<include>>

export ..> sync : <<include>>
sync --> graphdb : <<extend>>

semantic --> query : <<extend>>
transfer --> store : <<extend>>

note right of cleanup : "shared-memory.json\nhas been removed"

note bottom of graphdb : "Storage at:\n.data/knowledge-graph\n(Graphology + LevelDB)"

note bottom of export : "Auto-sync to:\n.data/knowledge-export"

note top of semantic : "Implemented in:\nmcp-server-semantic-analysis"

@enduml