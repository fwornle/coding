@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "Knowledge Management" {
    class NetworkAwareInstallationPattern <<pattern>> {
        -patternId: string
        -networkConfig: NetworkConfig
        -installationSteps: InstallationStep[]
        +analyzeNetworkTopology(): NetworkTopology
        +generateInstallationPlan(): InstallationPlan
        +validateConnectivity(): ValidationResult
        +executeInstallation(): ExecutionResult
    }

    class KnowledgeManager <<service>> {
        -graphDb: GraphDatabase
        -exportManager: ExportManager
        +storePattern(pattern: Pattern): void
        +retrievePattern(id: string): Pattern
        +syncToExport(): void
    }

    class SemanticAnalyzer <<service>> {
        -patternExtractor: PatternExtractor
        -codebaseAnalyzer: CodebaseAnalyzer
        +extractPatterns(codebase: Codebase): Pattern[]
        +analyzeSemantics(code: string): SemanticData
    }
}

package "Storage Layer" {
    class GraphDatabase <<database>> {
        -graphology: GraphologyInstance
        -levelDb: LevelDB
        -storagePath: string
        +store(entity: Entity): void
        +query(criteria: QueryCriteria): Entity[]
        +connect(): void
        +disconnect(): void
    }

    class ExportManager <<service>> {
        -exportPath: string
        -autoSync: boolean
        +exportToJson(data: GraphData): void
        +scheduleSync(): void
        +validateExport(): boolean
    }

    class LevelDB <<persistence>> {
        -dbPath: string
        -options: LevelDbOptions
        +put(key: string, value: any): void
        +get(key: string): any
        +delete(key: string): void
    }

    class GraphologyInstance <<graph>> {
        -nodes: Node[]
        -edges: Edge[]
        +addNode(node: Node): void
        +addEdge(edge: Edge): void
        +traverse(strategy: TraversalStrategy): Path[]
    }
}

package "Integration Layer" {
    class MCPServer <<server>> {
        -semanticAnalyzer: SemanticAnalyzer
        -knowledgeManager: KnowledgeManager
        +handleRequest(request: MCPRequest): MCPResponse
        +processSemanticAnalysis(code: string): AnalysisResult
    }

    class UKBUnified <<library>> {
        -patternRegistry: PatternRegistry
        +registerPattern(pattern: Pattern): void
        +getPattern(id: string): Pattern
        +listPatterns(): Pattern[]
    }
}

package "Configuration" {
    class DataPaths <<config>> {
        +KNOWLEDGE_GRAPH_PATH: string = ".data/knowledge-graph"
        +KNOWLEDGE_EXPORT_PATH: string = ".data/knowledge-export"
        +validatePaths(): boolean
    }

    class NetworkConfig <<config>> {
        -topology: NetworkTopology
        -connectivity: ConnectivityRules
        -security: SecurityConfig
    }
}

' Relationships
NetworkAwareInstallationPattern --* KnowledgeManager : stored by
KnowledgeManager --> GraphDatabase : uses
SemanticAnalyzer --> NetworkAwareInstallationPattern : extracts
GraphDatabase --> GraphologyInstance : contains
GraphDatabase --> LevelDB : persists with
GraphDatabase --> ExportManager : exports via
MCPServer --> SemanticAnalyzer : uses
MCPServer --> KnowledgeManager : queries
UKBUnified --> NetworkAwareInstallationPattern : provides
NetworkAwareInstallationPattern --> NetworkConfig : configured by
ExportManager --> DataPaths : writes to
GraphDatabase --> DataPaths : stores at

' Notes
note right of GraphDatabase : "Graphology + LevelDB\nat .data/knowledge-graph"
note right of ExportManager : "JSON exports at\n.data/knowledge-export\n(auto-synced)"
note bottom of NetworkAwareInstallationPattern : "Pattern extracted from codebase\nanalysis across multiple modules"

@enduml