@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "Knowledge Management" {
    abstract class ArchitecturalEvolutionPattern <<TransferablePattern>> {
        -patternId: String
        -evolutionStage: String
        -transferabilityScore: Float
        +extractPattern(): Pattern
        +applyPattern(): void
        +validateTransfer(): Boolean
    }
    
    class KnowledgeManager {
        -graphStorage: GraphologyAdapter
        -levelDbStore: LevelDBAdapter
        -exportPath: String
        +storePattern(pattern: Pattern): void
        +retrievePattern(id: String): Pattern
        +syncToJson(): void
    }
    
    class PatternExtractor {
        -codebaseAnalyzer: CodebaseAnalyzer
        -patternTemplates: Map
        +analyzeCodebase(): List<Pattern>
        +identifyEvolutionStages(): List<Stage>
        +extractTransferableElements(): List<Element>
    }
}

package "Storage Layer" {
    class GraphologyAdapter {
        -graphInstance: Graph
        -dataPath: String
        +addNode(node: Node): void
        +addEdge(edge: Edge): void
        +query(criteria: QueryCriteria): ResultSet
    }
    
    class LevelDBAdapter {
        -dbConnection: LevelDB
        -storagePath: String
        +put(key: String, value: Any): void
        +get(key: String): Any
        +batch(operations: List): void
    }
    
    class JsonExporter {
        -exportPath: String
        -autoSync: Boolean
        +exportToJson(data: Any): void
        +scheduleAutoSync(): void
        +validateExport(): Boolean
    }
}

package "Integration Layer" {
    class McpSemanticServer {
        -semanticAnalyzer: SemanticAnalyzer
        -patternMatcher: PatternMatcher
        +analyzeSemantics(input: String): Analysis
        +matchPatterns(analysis: Analysis): List<Match>
        +serveResults(): Response
    }
    
    class UnifiedKnowledgeBase {
        -patternRegistry: Map
        -evolutionTracker: EvolutionTracker
        +registerPattern(pattern: Pattern): void
        +trackEvolution(changes: List): void
        +unifyKnowledge(): KnowledgeGraph
    }
}

package "Implementation Sites" {
    class SourceKnowledgeManagement <<implementation>> {
        -location: "src/knowledge-management"
    }
    
    class LibUkbUnified <<implementation>> {
        -location: "lib/ukb-unified"
    }
    
    class McpServerIntegration <<implementation>> {
        -location: "integrations/mcp-server-semantic-analysis/src"
    }
}

' Relationships
ArchitecturalEvolutionPattern --|> KnowledgeManager
KnowledgeManager --> GraphologyAdapter
KnowledgeManager --> LevelDBAdapter
KnowledgeManager --> JsonExporter
PatternExtractor --> ArchitecturalEvolutionPattern
McpSemanticServer --> UnifiedKnowledgeBase
UnifiedKnowledgeBase --> ArchitecturalEvolutionPattern

' Implementation relationships
SourceKnowledgeManagement ..|> KnowledgeManager
LibUkbUnified ..|> UnifiedKnowledgeBase
McpServerIntegration ..|> McpSemanticServer

' Storage relationships
GraphologyAdapter --> LevelDBAdapter : "persists to"
JsonExporter ..> GraphologyAdapter : "exports from"

' Notes
note right of ArchitecturalEvolutionPattern : "Extracted from codebase analysis\nStored as reusable knowledge entity"
note bottom of GraphologyAdapter : "Storage: .data/knowledge-graph"
note bottom of JsonExporter : "Auto-sync: .data/knowledge-export"
note top of SourceKnowledgeManagement : "shared-memory.json REMOVED"

@enduml