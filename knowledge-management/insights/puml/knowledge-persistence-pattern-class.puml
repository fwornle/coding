@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "Knowledge Persistence Pattern" {
  class KnowledgePersistencePattern {
    - graphDatabase: GraphDatabase
    - knowledgeExporter: KnowledgeExporter
    - persistenceAgent: PersistenceAgent
  }

  abstract class GraphDatabase {
    {abstract} +store(entity: Entity)
    {abstract} +retrieve(entity Id: String): Entity
  }

  class Graphology <<service>> {
    +store(entity: Entity)
    +retrieve(entity Id: String): Entity
  }

  class LevelDB <<service>> {
    +store(entity: Entity)
    +retrieve(entity Id: String): Entity
  }

  GraphDatabase --|> Graphology
  GraphDatabase --|> LevelDB

  class KnowledgeExporter {
    +exportToJSON(knowledgeGraph: KnowledgeGraph)
  }

  class PersistenceAgent {
    - graphDatabaseAdapter: GraphDatabaseAdapter
    + persist(knowledgeGraph: KnowledgeGraph)
  }

  class GraphDatabaseAdapter {
    + store(knowledgeGraph: KnowledgeGraph)
    + retrieve(knowledgeGraphId: String): KnowledgeGraph
  }

  KnowledgePersistencePattern --* KnowledgeExporter
  KnowledgePersistencePattern --* PersistenceAgent
  PersistenceAgent --* GraphDatabaseAdapter
  GraphDatabaseAdapter --* GraphDatabase

  package "Event-Driven Architecture" {
    class EntityStoredEvent {
      - entity Id: String
    }

    KnowledgeExporter ..> EntityStoredEvent : listens to
  }

  package "VKB API" {
    class VkbApiClient {
      + visualize(knowledgeGraph: KnowledgeGraph)
      + operate(knowledgeGraph: KnowledgeGraph)
    }

    KnowledgePersistencePattern --* VkbApiClient
  }
}

@enduml