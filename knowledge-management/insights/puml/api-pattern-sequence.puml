@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant "Client" as C
participant "VKB Command" as VKB
participant "Graph Sync" as GS
participant "GraphDatabaseService" as GDS
participant "Knowledge Graph\n(.data/knowledge-graph)" as KG
participant "VkbApiClient" as API
participant "Parallel Workers" as PW
participant "JSON Export\n(.data/knowledge-export)" as JE

C -> VKB: Execute vkb command
activate VKB

VKB -> GDS: Initialize GraphDatabaseService
activate GDS

GDS -> KG: Connect to knowledge graph
activate KG

alt Batch Mode Semantic Analysis
    VKB -> PW: Deploy parallel workers
    activate PW
    
    loop For each batch
        PW -> GDS: Process semantic data
        GDS -> KG: Store knowledge patterns
    end
    
    deactivate PW
end

VKB -> API: Initialize VkbApiClient
activate API

API -> GDS: Query knowledge data
GDS -> KG: Retrieve graph data
KG --> GDS: Return graph results
GDS --> API: Return processed data

C -> GS: Execute graph-sync command
activate GS

GS -> GDS: Trigger synchronization
GDS -> KG: Extract knowledge graph
KG --> GDS: Return graph data

GDS -> JE: Auto-sync to JSON export
activate JE
note right of JE: Data-driven development\napproach with JSON exports

JE --> GDS: Sync confirmation
GDS --> GS: Sync completed
GS --> C: Synchronization complete

deactivate JE
deactivate GS
deactivate API
deactivate KG
deactivate GDS
deactivate VKB

@enduml