@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant ApiPattern as "ApiPattern (MCPAgent)"
participant GraphDatabaseService as "GraphDatabaseService"
participant VkbApiClient as "VkbApiClient"
participant PersistenceAgent as "PersistenceAgent"
participant GraphDatabaseAdapter as "GraphDatabaseAdapter"
participant MCPTools as "MCP Tools"

activate ApiPattern
ApiPattern ->> GraphDatabaseService: Request knowledge storage
GraphDatabaseService ->> ApiPattern: Provide knowledge storage

alt Synchronize GraphDB with JSON exports
    ApiPattern ->> GraphDatabaseService: graph-sync command
    GraphDatabaseService ->> ApiPattern: Synchronized GraphDB
end

ApiPattern ->> VkbApiClient: Request visualization
VkbApiClient ->> ApiPattern: Provide visualization

ApiPattern ->> MCPTools: Request knowledge operations
MCPTools ->> ApiPattern: Perform knowledge operations

ApiPattern ->> PersistenceAgent: Persist knowledge entities
PersistenceAgent ->> GraphDatabaseAdapter: Store knowledge entities
GraphDatabaseAdapter ->> GraphDatabaseService: Store knowledge entities in GraphDB

deactivate ApiPattern

@enduml