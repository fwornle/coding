@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

participant VkbCli as "VkbCli (Entity)"
participant GraphDatabaseService as "GraphDatabaseService"
participant GraphDatabaseAdapter as "GraphDatabaseAdapter"
participant Graphology as "Graphology (Graph Database)"
participant LevelDB as "LevelDB (Graph Database)"
participant JSON_Export as "JSON Export (.data/knowledge-export)"
participant vkb_Command as "vkb Command (Visualization)"
participant MCP_Tools as "MCP Tools (Knowledge Operations)"

VkbCli ->> GraphDatabaseService: Request data storage/access
GraphDatabaseService ->> GraphDatabaseAdapter: Request data access abstraction
GraphDatabaseAdapter ->> Graphology: Store/Retrieve data from Graphology
GraphDatabaseAdapter ->> LevelDB: Store/Retrieve data from LevelDB
Graphology ->> LevelDB: Auto-synchronize data
LevelDB ->> JSON_Export: Auto-synchronize JSON exports
VkbCli ->> vkb_Command: Request visualization
vkb_Command ->> Graphology: Retrieve data for visualization
VkbCli ->> MCP_Tools: Perform knowledge operations
MCP_Tools ->> Graphology: Update data after operations
MCP_Tools ->> JSON_Export: Update JSON exports after operations

alt Success
    JSON_Export ->> VkbCli: Return updated JSON exports
    Graphology ->> VkbCli: Return updated graph data
else Failure
    JSON_Export ->> VkbCli: Return error message
    Graphology ->> VkbCli: Return error message
end

@enduml