@startuml
!include /Users/q284340/Agentic/coding/docs/puml/_standard-style.puml

package "SemanticAnalysisWorkflowIssue - MCPAgent Architecture" {

  package "Core Implementation" {
    component [src/knowledge-management] as km <<core>>
    component [lib/ukb-unified] as ukb <<core>>
    component [integrations/mcp-server-semantic-analysis/src] as mcp <<api>>
  }

  package "Storage Layer" {
    component [Graphology] as graph <<storage>>
    component [LevelDB] as leveldb <<storage>>
    database ".data/knowledge-graph" as kgstore <<storage>>
    database ".data/knowledge-export" as export <<storage>>
    graph --> kgstore : "stores to"
    leveldb --> kgstore : "persists to"
    kgstore --> export : "auto-sync"
  }

  package "Multi-Agent System" {
    component [GitHistoryAgent] as git <<agent>>
    component [VibeHistoryAgent] as vibe <<agent>>
    component [ObservationGenerationAgent] as obs <<agent>>
    component [InsightGenerationAgent] as insight <<agent>>
    component [ContentValidationAgent] as valid <<agent>>
    component [QualityAssuranceAgent] as qa <<agent>>
  }

  ' Core relationships
  mcp --> km : "orchestrates"
  km --> ukb : "uses unified lib"
  
  ' Agent workflows
  git --> obs : "feeds data"
  vibe --> obs : "feeds data"
  obs --> insight : "generates insights"
  insight --> valid : "validates content"
  valid --> qa : "quality check"
  
  ' Storage interactions
  km --> graph : "manages knowledge"
  ukb --> leveldb : "persistent storage"
  
  ' MCP connections
  mcp --> git : "coordinates"
  mcp --> vibe : "coordinates"
  qa --> export : "exports results"

  note top of kgstore : "Primary knowledge storage\nusing Graphology + LevelDB"
  note bottom of export : "JSON exports for external\nconsumption - auto-synced"
  note right of mcp : "MCP Server provides\nsemantics analysis interface"
}

@enduml