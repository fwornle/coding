@startuml
!include _standard-style.puml

title Enhanced Health Monitoring - 6 Layers

left to right direction

package "Failsafe" as L0 {
  component [Watchdog] as SMW <<infra>>
}

package "Services" as L1 {
  component [GSC] as GSC <<core>>
  component [GLC] as GLC <<core>>
}

package "Verify" as L23 {
  component [Pre-Session] as MV <<infra>>
  component [Health] as HV <<core>>
}

package "Display" as L4 {
  component [StatusLine] as SHM <<core>>
  component [Dashboard] as Dash <<api>>
}

package "Monitor" as L5 {
  component [Transcript] as ETM <<core>>
  component [Logging] as LLC <<util>>
}

database [PSM\nRegistry] as PSM <<storage>>

database [Health\nFiles] as HF <<storage>>

' Main flow
SMW CONTROL_LINE GSC : restart
GSC CONTROL_LINE GLC : coordinate
GLC CONTROL_LINE ETM : recover
MV ..> HV : trigger
HV DATA_LINE SHM : status
SHM SYNC_LINE Dash : display

' Health data flow
ETM DATA_LINE HF : write
SHM SYNC_LINE HF : read
HV SYNC_LINE HF : check

' PSM usage
PSM -up-> SMW
PSM -up-> GSC
PSM -up-> SHM
PSM -up-> ETM

@enduml
