@startuml lsl-architecture
!include _standard-style.puml

title Live Session Logging (LSL) Architecture

left to right direction

' Larger fonts for presentation
skinparam defaultFontSize 28
skinparam packageFontSize 30
skinparam componentFontSize 26
skinparam arrowThickness 6
skinparam nodesep 60
skinparam ranksep 80

package "Session" {
  [Launch] as Launch <<external>>
  [User] as User <<external>>
  [Transcript] as Transcript <<external>>
}

package "Monitoring" #FFE6E6 {
  [Watchdog] as Watchdog <<infra>>
  [Coordinator] as GSC <<infra>>
  [Verifier] as Verifier <<infra>>
}

package "Monitor" {
  [Analyzer] as Analyzer <<core>>
  [Detector] as Detector <<core>>
}

package "5-Layer Classifier" #E8F5E8 {
  [L0: Session] as L0 <<core>>
  [L1: Path] as L1 <<core>>
  [L2: Keyword] as L2 <<core>>
  [L3: Embedding] as L3 <<core>>
  [L4: Semantic] as L4 <<agent>>
  [Orchestrator] as Orchestrator <<core>>
}

package "Routing" {
  [Router] as Router <<core>>
  [Logger] as Logger <<core>>
}

package "Storage" {
  database "Project" as ProjectHistory <<storage>>
  database "Coding" as CodingHistory <<storage>>
}

' Main flow
Launch --> Verifier
Verifier --> Watchdog
Verifier --> GSC
Verifier --> Analyzer

Launch --> User
User --> Transcript
Transcript --> Analyzer

Analyzer --> Detector
Analyzer --> Orchestrator

' Classification cascade
Orchestrator --> L0
L0 --> L1
L1 --> L2
L2 --> L3
L3 --> L4

' Routing
Orchestrator --> Router
Router --> Logger

' Storage
Logger --> ProjectHistory
Logger --> CodingHistory

' Monitoring
Watchdog --> GSC
GSC --> Analyzer

@enduml