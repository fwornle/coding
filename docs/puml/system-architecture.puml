@startuml system-architecture
!include _standard-style.puml

title Knowledge Management System Architecture

package "Knowledge Capture Layer" {
  [Git Repository] as git
  [Conversation Logs] as logs
  [UKB Command] as ukb
  [UKB-CLI (Node.js)] as ukbcli
  [Knowledge API] as kapi
  [Commit Analysis] as analysis
  [Semantic Analysis] as semantic
}

package "Data Storage Layer" {
  database [shared-memory.json] as storage
  database [MCP Memory Server] as mcpmem
  note right of mcpmem
    • In-memory graph database
    • Session persistence
    • Cross-session continuity
  end note
}

package "Visualization Layer" {
  [VKB Command] as vkb
  [VKB-CLI (Node.js)] as vkbcli
  [VKB Server Manager] as vkbserver
  [HTTP Server] as server
  [Memory Visualizer] as visualizer
  [Web Browser] as browser
}

package "AI Agent Integration" {
  [Claude Code] as claude
  [GitHub Copilot] as copilot
  [MCP Server Interface] as mcp
}

git --> analysis : Commit data
logs --> semantic : Conversation data
analysis --> ukbcli : Extracted insights
semantic --> ukbcli : Pattern insights
ukb --> ukbcli : Delegates to
ukbcli --> kapi : Uses API
kapi --> storage : Knowledge graph updates
storage <--> mcpmem : Sync operations

storage --> vkbcli : Read memory data
vkb --> vkbcli : Delegates to
vkbcli --> vkbserver : Server management
vkbserver --> server : Start/manage server
server --> visualizer : Serve graph data
visualizer --> browser : Interactive visualization

claude --> mcp : MCP tools
copilot --> storage : Direct access
mcp <--> mcpmem : Memory operations
claude --> ukb : Trigger knowledge capture
copilot --> ukb : Trigger knowledge capture
claude --> logs : Generate conversations
copilot --> logs : Generate conversations

note bottom of storage
  **File-based Storage:**
  • Git-tracked JSON format
  • Team collaboration ready
  • Version controlled
end note

note bottom of visualizer
  **Interactive Visualization:**
  • D3.js force-directed graph
  • Color-coded entity types
  • Real-time updates
end note

@enduml