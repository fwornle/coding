@startuml live-logging-flow
!include _standard-style.puml
skinparam direction top to bottom layout
title Live Logging Data Flow (Final Design)

participant "Claude Code" as Claude
participant "StatusLine" as Status
participant "TranscriptAnalyzer" as Analyzer
participant "Groq AI" as Groq
participant "SessionFile" as Session

== Real-time Processing ==

Claude -> Claude : User executes tools
Claude -> Claude : Writes transcript to\n~/.claude/conversations/*.jsonl

loop Every few seconds
    Status -> Analyzer : quickAnalyze() < 10ms
    Analyzer -> Claude : Read transcript file
    Analyzer -> Status : Return session status
    Status -> Status : Display in status bar
    
    alt New interactions found
        Analyzer -> Groq : Background analysis
        Groq -> Session : Update live session file
        note over Session : .specstory/history/\nYYYY-MM-DD_live-session.md
    end
end

@enduml