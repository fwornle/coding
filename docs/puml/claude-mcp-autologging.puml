@startuml claude-mcp-autologging
!include _standard-style.puml


title Claude MCP Post-Session Auto-Logging Architecture ✅ WORKING

actor Developer as Dev
participant "claude-mcp" as Launcher
participant "Claude CLI" as Claude
participant "MCP Framework" as MCP
participant "post-session-logger.js\n✅ OPERATIONAL" as Logger
database ".specstory/history/" as Logs

Dev -> Launcher : starts claude-mcp
activate Launcher
Launcher -> Claude : launches Claude with MCP config
activate Claude
Claude -> MCP : initializes MCP servers
activate MCP

Dev <-> Claude : conversation session
note right: User and assistant\nexchanges occur

Dev -> Claude : exits session
Claude -> MCP : cleanup
deactivate MCP
Claude -> Launcher : session complete
deactivate Claude

Launcher -> Logger : triggers post-session processing
activate Logger
Logger -> Logger : analyze session data
note right: Extract user/assistant\nexchanges from session

Logger -> Logger : detect content type
note right: Coding-related content?\nRoute to appropriate repo

alt Coding-related content
    Logger -> Logs : save to coding/.specstory/history/
else Project-specific content
    Logger -> Logs : save to project/.specstory/history/
end

Logger -> Launcher : logging complete
deactivate Logger
Launcher -> Dev : session finished
deactivate Launcher

note over Logger : ✅ FULLY WORKING: Post-session processing\nensures all conversations are captured\nwith intelligent routing\n\nReliable and automatic operation

@enduml