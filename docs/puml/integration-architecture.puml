@startuml
!include _standard-style.puml

title Integration Architecture - How Components Connect

top to bottom direction

package "Coding Core System" as core #E8F5E8 {
  [LSL\nSystem] as lsl <<core>>
  [Trajectory\nGeneration] as trajectory <<core>>
  [Constraint\nMonitoring] as constraints <<core>>
}

package "MCP Integration Layer" as mcp #E0E7FF {
  [Semantic\nAnalysis\n(11 Agents)] as semantic <<mcp>>
  [Serena\nAST] as serena <<mcp>>
  [Constraint\nMonitor] as monitor <<mcp>>
}

cloud "Fast LLM Providers" as llm #F0F0F0 {
  [Groq\n(gpt-oss-20b)] as groq <<llm>>
  [OpenAI\n(gpt-4o-mini)] as openai <<llm>>
}

' Connections
lsl -down-> groq : Layer 4 Classification\n(fast semantic)
lsl -down-> openai : Fallback
trajectory -down-> semantic : MCP Protocol\n(deep analysis)
trajectory -down-> serena : Repository scan
constraints -down-> monitor : PreToolUse Hook

note bottom of mcp
  **MCP Servers** provide:
  • Standardized tool definitions
  • Bi-directional communication
  • Deep analysis capabilities
end note

note right of lsl
  **LSL Classification**
  5-layer system with fast
  semantic analysis (Layer 4)
  using Groq/OpenAI - NOT
  the 11-agent MCP server
end note

note right of trajectory
  **Trajectory Analysis**
  Uses MCP Semantic Analysis
  for deep repository insights
  and architectural patterns
end note

@enduml
